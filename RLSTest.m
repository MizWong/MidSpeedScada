clear all;

clear fnRLS;

x  = 5*[0.891654746946702 + 0.589208175441752i,0.783260550268899 + 0.184635364004855i,0.795895928174080 + 0.545313082587492i,0.242260174028368 + 0.848794926602191i,0.692058656879825 + 0.825108106743632i,0.925534494793317 + 0.199392779095673i,0.0847847442829501 + 0.0937038085395148i,0.999515265706689 + 0.311777841043518i,0.0313349912168640 + 0.138305092520659i,0.0451660517188327 + 0.263246721380001i,0.774964365082762 + 0.0315297436709463i,0.531589488045148 + 0.590779100682348i,0.835335853227833 + 0.988864863791674i,0.773097674074238 + 0.0635990717327932i,0.710342342413044 + 0.142822911177549i,0.871772651993244 + 0.0253433217655701i,0.300577901237929 + 0.367230136893159i,0.657230667732861 + 0.395415968666438i,0.0353796583549684 + 0.414714058769705i,0.0784241603230450 + 0.816086479094231i,0.742386748268563 + 0.624600173059373i,0.767780830431390 + 0.713888024489818i,0.937041516264072 + 0.919901979449544i,0.257922909626081 + 0.400889914380438i,0.416746108778406 + 0.345859837521990i,0.772843033884121 + 0.603420123899366i,0.105043919744038 + 0.478737419984134i,0.133013288677645 + 0.821941804801761i,0.781836795160695 + 0.876972869643887i,0.0112000853747142 + 0.859298059587265i,0.627405965706501 + 0.706151977771791i,0.336802944722376 + 0.518103853919245i,0.577727939037871 + 0.412967468323102i,0.927754974900757 + 0.928597188812124i,0.674390376237118 + 0.544432237165339i,0.281822037043033 + 0.0627553996317130i,0.173636787792662 + 0.159072426140550i,0.323975953628767 + 0.281519213137043i,0.349967555748464 + 0.306415897214171i,0.961829692620772 + 0.368159412894002i,0.747296290305927 + 0.0816523949619359i,0.0193382448971969 + 0.818348592984607i,0.597721043141785 + 0.379342682794101i,0.883795707742561 + 0.713124784226820i,0.0819960906187458 + 0.474692502143840i,0.872541136949143 + 0.125065741127363i,0.166689273056221 + 0.248070828613630i,0.731206517030103 + 0.496001357804577i,0.119933033173217 + 0.110201204531928i,0.577618497709255 + 0.543590502422140i,0.167067414948959 + 0.709411976311059i,0.679884640153128 + 0.831133822348940i,0.506507376843629 + 0.610576381621120i,0.849600874710876 + 0.423341636712628i,0.533807688353119 + 0.949709403637004i,0.919292633591923 + 0.717029108341768i,0.239480809940345 + 0.823196470920286i,0.499861361805877 + 0.886185967951333i,0.499706617595582 + 0.144851495166256i,0.954283103859052 + 0.367728471676986i,0.891577730068146 + 0.0772936685019948i,0.433737866015131 + 0.361914894127932i,0.242547647009553 + 0.646027388924136i,0.743976316015952 + 0.386502095214700i,0.118575912329418 + 0.0576836879668399i,0.295806401860111 + 0.933936037742663i,0.211537150500328 + 0.990342499838142i,0.266860958903892 + 0.629052252327875i,0.203601167085844 + 0.517491438159293i,0.159323595365343 + 0.0856234796396200i,0.766188066456996 + 0.312260176770288i,0.715131167428421 + 0.597247380327833i,0.586901815264690 + 0.728074897488862i,0.570634280703872 + 0.778317124841025i,0.350628104146553 + 0.719661750605683i,0.0890454405264642 + 0.616002844657659i,0.198113715024554 + 0.906700554972368i,0.516669597507738 + 0.223761197109073i,0.769297985730811 + 0.616878803458589i,0.649913027560790 + 0.531271000532756i,0.622035955859162 + 0.788007740279042i,0.00111823993912108 + 0.522366033067688i,0.946826466720479 + 0.568636723081410i,0.189135671073441 + 0.705111764933295i,0.720340839675226 + 0.601199860663859i,0.700968986830731 + 0.131772434127693i,0.547580669406680 + 0.812980637380292i,0.0965116184300814 + 0.327128418057789i,0.640257344466351 + 0.131882438576654i,0.0678848284744933 + 0.667395141734981i,0.937937863505651 + 0.0269192448253833i,0.414791374280762 + 0.586078285105246i,0.493210198681672 + 0.539933467004775i,0.273967259109376 + 0.389405502566252i,0.146497314696240 + 0.0248401457363207i,0.555415564315921 + 0.507645825546312i,0.0524367349619662 + 0.730828796088663i,0.777769490056995 + 0.240945646284990i,0.715948546068283 + 0.579153089846192i,0.390345591737623 + 0.836072138461931i,0.702587153604895 + 0.575298047584941i,0.508975528142121 + 0.0482973646042212i,0.981366313009600 + 0.145631168584095i,0.307980415239985 + 0.721212129851523i,0.112982056443574 + 0.382712613578893i,0.415677322667722 + 0.0494248994036421i,0.881207248639848 + 0.625124276206210i,0.901663591447916 + 0.557803839634233i,0.0115638124690060 + 0.595119145456606i,0.111522695268579 + 0.818967406974393i,0.885280621486302 + 0.244704586224724i,0.438376680245093 + 0.252069037006585i,0.355933385802872 + 0.374400741457947i,0.428116413692868 + 0.236264076308329i,0.432003453709194 + 0.154424658234449i,0.293178297320637 + 0.949101005107090i,0.745236966308929 + 0.914679461838574i,0.320147953780698 + 0.596599653082196i,0.0346395285443991 + 0.000171622411613837i,0.815367337003616 + 0.721293088207113i,0.781903083436455 + 0.485298305445096i,0.813317698100693 + 0.129185478246391i,0.707311519739363 + 0.967545106442579i,0.849811506931193 + 0.0579995348405655i,0.980605856409187 + 0.436543956659856i,0.499126131290724 + 0.332030003407485i,0.343443059898249 + 0.256195979592090i,0.951309088428110 + 0.818853304962380i,0.235794430006797 + 0.495474815585231i,0.679980467043714 + 0.270230971713995i,0.775428422640632 + 0.220894057988958i,0.907498617790837 + 0.295403288827264i,0.261232346172670 + 0.817962819190552i,0.102409406185793 + 0.880531305610487i,0.445428396700357 + 0.109129602151099i,0.732324948184434 + 0.0942145920268861i,0.824651107693056 + 0.550625602372675i,0.938342603397729 + 0.305517840445675i,0.316609751553519 + 0.329425828159009i,0.231222899937732 + 0.0846079007200160i,0.667800664067077 + 0.222406131800023i,0.873722696088929 + 0.718025556701512i,0.224835217984893 + 0.351452412863925i,0.145870785706838 + 0.913889644145327i,0.319485720608260 + 0.287009962263688i,0.534860624066600 + 0.616000830370422i,0.213274036425726 + 0.194097905763157i,0.402955471696994 + 0.949732346653091i,0.493456214858283 + 0.119237237382466i,0.370470055330213 + 0.253144001409282i,0.892197154519770 + 0.292812216521363i,0.877502418364384 + 0.635002611110371i,0.632910058984550 + 0.535232693554137i,0.815719923739488 + 0.492314151866575i,0.431942074169145 + 0.601776717242671i,0.258751367442985 + 0.479023670439577i,0.581328107644560 + 0.950760017096898i,0.776916604047734 + 0.524373553661559i,0.881604085552337 + 0.918718317080754i,0.0457053626243028 + 0.161643985361431i,0.313714665720327 + 0.173232270092409i,0.612628729163805 + 0.332821640428637i,0.331575927443269 + 0.884884908131698i,0.612080180033496 + 0.897444515920391i,0.724324573348368 + 0.504929009169880i,0.378882251432633 + 0.00224535779373602i,0.170821802331315 + 0.00108799057268272i,0.857600267715511 + 0.139485447813611i,0.940379074383419 + 0.508246416996723i,0.119120324854972 + 0.196922704638077i,0.364729653651978 + 0.0234609360296186i,0.566251550148887 + 0.422600270271381i,0.506656597007346 + 0.0261011404932994i,0.589751383261841 + 0.437474076010310i,0.590436925522474 + 0.386167611449144i,0.324605027991157 + 0.496324225771932i,0.423453268130518 + 0.560111176925722i,0.238968182846167 + 0.00349392461606513i,0.991282177926417 + 0.133473169143758i,0.0738577487566213 + 0.604959540657679i,0.175967278408710 + 0.273261383741881i,0.160087857202253 + 0.745687373344415i,0.443651783778071 + 0.198803218140631i,0.0869554020853089 + 0.694048232076524i,0.255422558429749 + 0.734207458493931i,0.264714618633717 + 0.513949512451433i,0.257876027657552 + 0.778050688076939i,0.438509499046038 + 0.181894588043129i,0.965833106147756 + 0.262457730279354i,0.860050071999731 + 0.266243809905449i,0.199490904232619 + 0.767468738519252i,0.436221056596086 + 0.760248214908753i,0.981099427594498 + 0.00141039327659198i,0.713852606476726 + 0.829978263492227i,0.446053020416353 + 0.357535652071117i,0.912847693981724 + 0.0679777973798308i,0.686984318448916 + 0.974103736606643i,0.861056095517700 + 0.528393906248694i,0.764375618799360 + 0.272094809160350i,0.126984974044973 + 0.348993567640639i,0.401692951670644 + 0.226824969962488i,0.487028098138987 + 0.960692740595274i,0.647870873296377 + 0.399366291516462i,0.679284868467638 + 0.594114702274675i,0.816587350942877 + 0.214600979207100i,0.724835970894040 + 0.197745145779235i,0.680586277069714 + 0.0648366134939852i,0.0280521438380970 + 0.0810054988980892i,0.751835247883008 + 0.903940554141069i,0.603199336479210 + 0.386027329140199i,0.0419068102308799 + 0.345967612810908i,0.756392781308334 + 0.822722697991014i,0.252094980283558 + 0.390245527876787i,0.404727822380036 + 0.0526445470444972i,0.245341135568210 + 0.0767597398508222i,0.400358281249571 + 0.709955479706919i,0.475167883434230 + 0.886748809431099i,0.607055576611374 + 0.658627658846514i,0.598194676126550 + 0.146018063493497i,0.188787902106132 + 0.256125891585448i,0.690467876654353 + 0.483094509781214i,0.558292317716296 + 0.0341116184271139i,0.120839231895793 + 0.920097251710692i,0.170684897695263 + 0.537263037225255i,0.936194819221424 + 0.850362714131925i,0.619380113087942 + 0.296216392028854i,0.301913273037047 + 0.642788953749458i,0.781987228174150 + 0.612503095795408i,0.993648484817027 + 0.381854683743438i,0.514105969519412 + 0.441267169542081i,0.237030741853081 + 0.190012250265493i,0.761422572369598 + 0.860992322120476i,0.314853437077124 + 0.355878486759043i,0.779071334672072 + 0.260319799132133i,0.266677360699855 + 0.165258519558006i,0.568477340236072 + 0.170729921951498i,0.604895495634138 + 0.780664234289956i,0.707305674946946 + 0.261206060849548i,0.284369527756405 + 0.227577398049603i,0.965755036365188 + 0.379976948148014i,0.251415249677308 + 0.430164928607626i,0.599301254872746 + 0.308667576219418i,0.337422502944554 + 0.717116011009430i,0.0139305897943350 + 0.308269284342308i,0.447966040763283 + 0.936091065192826i,0.189056966710749 + 0.330646213894448i,0.723248796659598 + 0.0245474575664126i,0.738342080563082 + 0.277913981517164i,0.0179529177628074 + 0.703955625448571i,0.462509288774458 + 0.958066881112155i,0.987509851635875 + 0.0917138808180483i,0.500773441233817 + 0.177152337746127i,0.594320655310904 + 0.495709960046927i,0.402208657892970 + 0.648768357019896i,0.190007963744649 + 0.821157776110243i,0.418655458947520 + 0.440085668617476i,0.319587226545298 + 0.578332010859222i,0.225901130646623 + 0.665764965456736i,0.296903662334751 + 0.145320712914438i,0.699210146270814 + 0.181418304086139i,0.541628357662807 + 0.641419797668793i,0.186300537211018 + 0.250703646731281i,0.334988947451929 + 0.222060652100238i,0.763524573427719 + 0.154111483797119i,0.0641276354103582 + 0.926186077108468i,0.136397127399942 + 0.437033314002031i,0.508473347096793 + 0.398343558519717i,0.861167229530497 + 0.648188869622599i,0.943863965878166 + 0.500368693330872i,0.965353313318813 + 0.580798653059208i,0.137994583437202 + 0.994717264216378i,0.945857430536284 + 0.0325733184054757i,0.701824258910001 + 0.545374178551700i,0.194748467788363 + 0.233318770364466i,0.0745453936860026 + 0.117706345617926i,0.879712037878843 + 0.183776141640177i,0.518572685858024 + 0.919477862335769i,0.383544669321411 + 0.753927969797514i,0.792722938256454 + 0.889276355259592i,0.963577047214362 + 0.826635040719543i,0.741858889276954 + 0.518877626708816i,0.171096554224085 + 0.215095467253352i,0.317764489898480 + 0.513879925798355i,0.841799198548013 + 0.695564013487025i,0.963953291375887 + 0.885556321147639i,0.219446733468097 + 0.316675931396190i,0.736871124324297 + 0.0455243712100272i,0.652449739265120 + 0.967577862093120i,0.510797736541087 + 0.205748049106556i,0.471078237298553 + 0.354980554663910i,0.461313334155242 + 0.563408856904480i,0.640102603847749 + 0.638286775906618i,0.136439966604031 + 0.243651443018705i,0.141227702486605 + 0.641372660362339i,0.996429987861885 + 0.149582639874234i,0.389810074311267 + 0.491354384705117i,0.933850209569941 + 0.846168065718688i,0.0797173646960155 + 0.370047785009546i,0.616066210544807 + 0.793143491275783i,0.931936941589080 + 0.0644789225054552i,0.276601122234080 + 0.792393184347728i,0.871590018329826 + 0.168462311709668i,0.161355070820694 + 0.264670558539460i,0.792224545268459 + 0.724354773211792i,0.0841845878612620 + 0.795320719628050i,0.791766571062361 + 0.791832427409028i,0.260872608994609 + 0.168166272603790i,0.971420403017547 + 0.256924154796079i,0.308759525173674 + 0.00221945149318703i,0.141224216946187 + 0.460721689401115i,0.533033500058481 + 0.946104311052114i,0.550578766329067 + 0.535541956751486i,0.306236375384899 + 0.231659429868902i,0.00932862445054195 + 0.227893004539129i,0.00855339007583500 + 0.411032788041427i,0.812742295464986 + 0.508212817365012i,0.242617888118294 + 0.638152587761065i,0.0321314714353566 + 0.0109958227211102i,0.168733634931847 + 0.784266762718698i,0.0471012673289516 + 0.652626051580467i,0.635788344164604 + 0.218018633065021i,0.823843850916750 + 0.986832453693048i,0.373907762858733 + 0.361320118341084i,0.0686256555243761 + 0.569162002962737i,0.0454400458714346 + 0.668713306096106i,0.436003279462342 + 0.876908665917010i,0.401627480122476 + 0.426438448813909i,0.421055565263402 + 0.199244556516755i,0.518448297652077 + 0.868845452833932i,0.561700120439008 + 0.589352107658540i,0.549974073302573 + 0.0333089734244859i,0.728694303852811 + 0.123565080780079i,0.137405671548818 + 0.661826848407966i,0.896508744161277 + 0.507552141217238i,0.454491853848061 + 0.331973181398141i,0.348867245009181 + 0.977396027652747i,0.339410673338174 + 0.0972514003613428i,0.916154088542239 + 0.555101836608001i,0.637489106340112 + 0.936199928776118i,0.320656583722338 + 0.355683724477787i,0.319846685994830 + 0.528474256002821i,0.457671409631091 + 0.0690546272961271i,0.323023100672485 + 0.502118041329633i,0.365518494597361 + 0.150454988942846i,0.418266522140120 + 0.714585238979968i,0.0773922418804243 + 0.770710878821036i,0.560660318396210 + 0.280488627866613i,0.825093505985755 + 0.401634954546006i,0.379921975150560 + 0.111540917997904i,0.513636231701932 + 0.774265357407346i,0.340534232516067 + 0.200261733194051i,0.433851983090093 + 0.723114153700494i,0.0774714587805869 + 0.653751455827338i,0.906973295728918 + 0.589018004559094i,0.629483555761612 + 0.695556271314010i,0.716428208132592 + 0.487646310042858i,0.466187590942178 + 0.274926721411970i,0.779711268642396 + 0.383273783644700i,0.295716009172983 + 0.621950094163380i,0.120037040402769 + 0.747040265831436i,0.471186737295432 + 0.455438749542669i,0.0369768444496488 + 0.722738021534892i,0.852548011345629 + 0.512663708178089i,0.368814115023734 + 0.234250156757628i,0.759024146698118 + 0.135904235131602i,0.296856162616048 + 0.793955036444190i,0.921843781238201 + 0.549222056032644i,0.666671022865646 + 0.889356438194413i,0.334845281201621 + 0.0612971027269879i,0.675768106537387 + 0.343664983850594i,0.253931677818333 + 0.561590045055465i,0.856337639025432 + 0.383942917436881i,0.293536217009110 + 0.440915979836743i,0.230544236878665 + 0.512937218696030i,0.252312293318489 + 0.981248557410855i,0.744880904700657 + 0.0977840330357359i,0.736975199691196 + 0.725615472915894i,0.983422112790379 + 0.731469550811124i,0.245032132926490 + 0.145404530986404i,0.465996047957251 + 0.143375368648075i,0.224478075691635 + 0.748914124536421i,0.253553683262217 + 0.997655980975469i,0.837852649001502 + 0.470558289243657i,0.801243926930023 + 0.417784886988676i,0.431780869604149 + 0.736608222916765i,0.823408992834507 + 0.246456225352005i,0.847931578597961 + 0.923385382725244i,0.182082744714606 + 0.855257989767923i,0.989338773065811 + 0.362632143871939i,0.385771442918225 + 0.992653721181533i,0.0578909717170925 + 0.121128839574704i,0.229376891323433 + 0.0622173893872343i,0.360595987490736 + 0.810837724132690i,0.0310107732478655 + 0.587384522944201i,0.979467512434370 + 0.0147701949115393i,0.812524920107007 + 0.962067159585918i,0.940886860487077 + 0.183614176371217i,0.156325288401522 + 0.0727808168193204i,0.458953942110272 + 0.805635277663005i,0.411903011050300 + 0.161568883642318i,0.915145640337264 + 0.0518131851988783i,0.861936643784828 + 0.836745052818836i,0.374290665641798 + 0.358161452043839i,0.893243923102808 + 0.770053204135917i,0.733711259539256 + 0.947733071131210i,0.268717112510689 + 0.284424526242962i,0.449739312296767 + 0.295738740116810i,0.274730321506397 + 0.869493516297914i,0.467880343865440 + 0.687590393579652i,0.784006395297659 + 0.0323929396032930i,0.953562467608745 + 0.578880511116103i,0.623647737361040 + 0.385357469233370i,0.612690527809789 + 0.542874012345152i,0.217965617279815 + 0.603696926951175i,0.369220755759721 + 0.109589304033678i,0.314601460485026 + 0.740057494030094i,0.199543882842954 + 0.744634645901843i,0.931419735621064 + 0.689569454727875i,0.955875868562630 + 0.884503525750280i,0.923381917317498 + 0.0950288735558604i,0.431395538409221 + 0.637575776322895i,0.468621501302221 + 0.214691555270417i,0.371564635562116 + 0.694589249692732i,0.595310985685557 + 0.129095163344463i,0.762872294481210 + 0.776870417402810i,0.646348742496278 + 0.128828583127306i,0.745850143897898 + 0.624444473182595i,0.651618485665212 + 0.938534850166847i,0.877812377946598 + 0.293816535099940i,0.444772767027299 + 0.537339462194041i,0.0541042763473307 + 0.0666964400519011i,0.660935686469153 + 0.366220910827063i,0.143705243349238 + 0.892666114600313i,0.597108074997404 + 0.338208448852778i,0.497242548188599 + 0.728128220449901i,0.0731875441674835 + 0.661999230489696i,0.752118203092057 + 0.401191287113161i,0.0492424489585018 + 0.974880810190441i,0.950657284863073 + 0.610470283543787i,0.926887101019575 + 0.00290269715241198i,0.737835085564962 + 0.168276829564852i,0.989952542015022 + 0.891443713272501i,0.718970742166051 + 0.412299211803442i,0.498219571785244 + 0.000748013401443703i,0.920906530320775 + 0.0491436116707799i,0.124864705043346 + 0.661893273439348i,0.376456607520823 + 0.235880048796168i,0.188115960722966 + 0.621709677763824i,0.783297887406099 + 0.905053847131982i,0.359597715562038 + 0.844134247898795i,0.193581978638967 + 0.887433827640999i,0.880322811147998 + 0.814121268093867i,0.285749938976993 + 0.508397920894872i,0.450398092698662 + 0.199949426715328i,0.697372252137235 + 0.221981275886562i,0.101718644904443 + 0.174353235500383i,0.367314193683548 + 0.685053373903170i,0.248774538639445 + 0.513643929303754i,0.113676387882686 + 0.821223225748722i,0.195211616072585 + 0.357368226668020i,0.912844128415752 + 0.204433836939999i,0.489770189667821 + 0.821489314020417i,0.944209148560614 + 0.341439819197158i,0.988432676565451 + 0.595703535856371i,0.317059686855354 + 0.252163542602553i,0.0910368332729148 + 0.501400037080226i,0.661808476401137 + 0.466958749101673i,0.509936389956032 + 0.538276681963256i,0.614533806599164 + 0.938290138762161i,0.141729921595627 + 0.160341066634670i,0.156502610910218 + 0.0711120950367343i,0.985246424747060 + 0.493437576891397i,0.211370145523612 + 0.00883566196463104i,0.465460553387157 + 0.664834585560811i,0.483359693183716 + 0.824056602873768i,0.994989167966031 + 0.0544246214499080i,0.592789587006897 + 0.277266013111863i,0.0332545780053007 + 0.411539251348072i,0.703790293216355 + 0.552819250121214i,0.939050164384721 + 0.412392086956693i,0.441441723271921 + 0.0287635598787246i,0.100698803462079 + 0.316186423199592i,0.353048827464920 + 0.905783844923370i,0.611652562978423 + 0.460876559376094i,0.0142279206199156 + 0.296008912550380i,0.877467139604651 + 0.148785520094460i,0.598706707615321 + 0.363041530698730i,0.438875907960508 + 0.935262456388528i,0.871928845993190 + 0.0521259800590431i,0.847073285978236 + 0.882650884360210i,0.499166382109049 + 0.0945341041551592i,0.861574538660162 + 0.899930637789005i,0.881764792924101 + 0.246534742492704i,0.422403624363311 + 0.659794916630486i,0.981573705255034 + 0.191434878424536i,0.577301699104020 + 0.551890188941713i,0.236775088962695 + 0.651829904258146i,0.0950920165223990 + 0.307362412596394i,0.774678002040676 + 0.398216830956012i,0.974955603699991 + 0.640941581188711i];
b  = fir1(31,0.5);     % FIR system to be identified
n  = 0; % Observation noise signal
d  = filter(b,1,x)+n;  % Desired signal
P0 = 10*eye(32); % Initial sqrt correlation matrix inverse
lam = 0.99;            % RLS forgetting factor

hRLS = lineareq(32,rls(lam));
hRLS.SigConst = [-1 -1];

y = equalize( hRLS, x.', d.' );

% ha = adaptfilt.rls(32,lam,P0);
% [y,e] = filter(ha,x,d);
% plot(1:500,[y]);
% % xlabel('Time Index'); ylabel('Signal Value');
% % subplot(2,1,2); stem([b.',ha.Coefficients.']);
% % legend('Actual','Estimated');
% % xlabel('Coefficient #'); ylabel('Coefficient valUe');  grid on;

plot(phase(y));

w = zeros(32,1);
y = zeros(1,length(x));

hMyRLS = fnRLSCreate(32, lam);

for ii = 1:1:length(x)
    if ii < 33
        y(ii) = [zeros(1,32-ii),x(1:ii)] * w;
        e = d(ii) - y(ii);
        [deltaW, hMyRLS] = fnRLS( hMyRLS, [zeros(1,32-ii),x(1:ii)].', e, 0 );
        w = w + deltaW;
    else
        y(ii) = x(ii-32+1:ii) * w;
        e = d(ii) - y(ii);
        [deltaW, hRLS] = fnRLS( hMyRLS, x(ii-32+1:ii).', e, 0 );
        w = w + deltaW;
    end
end

hold on;
plot(phase(y))

